<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FunnyFunnel - Lead Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéØ</text></svg>">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>FunnyFunnel</h1>
            <p class="subtitle">Sales Lead Generator f√ºr KI-Jobanzeigen</p>
        </header>

        <!-- Toolbar -->
        <div class="toolbar">
            <div class="filters">
                <select id="statusFilter" class="filter-select">
                    <option value="">Alle Status</option>
                    <option value="neu">Neu</option>
                    <option value="aktiviert">Aktiviert</option>
                    <option value="recherchiert">Recherchiert</option>
                    <option value="anschreiben_erstellt">Anschreiben erstellt</option>
                    <option value="angeschrieben">Angeschrieben</option>
                    <option value="antwort_erhalten">Antwort erhalten</option>
                </select>
                <input type="text" id="keywordFilter" class="filter-input" placeholder="Nach Keyword filtern...">
                <button id="applyFilters" class="btn btn-secondary">
                    <span>üîç</span> Filtern
                </button>
            </div>
            <div class="actions">
                <button id="openImportModal" class="btn btn-success">
                    <span>üì•</span> StepStone Import
                </button>
                <button id="exportCSV" class="btn btn-primary">
                    <span>üìä</span> CSV Export
                </button>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats" id="stats">
            <div class="stat-item clickable" onclick="filterByStatus('')">
                <span class="stat-value" id="statTotal">0</span>
                <span class="stat-label">Gesamt</span>
            </div>
            <div class="stat-item clickable" onclick="filterByStatus('neu')">
                <span class="stat-value" id="statNeu">0</span>
                <span class="stat-label">Neu</span>
            </div>
            <div class="stat-item clickable" onclick="filterByStatus('aktiviert')">
                <span class="stat-value" id="statAktiviert">0</span>
                <span class="stat-label">Aktiviert</span>
            </div>
            <div class="stat-item clickable" onclick="filterByStatus('recherchiert')">
                <span class="stat-value" id="statRecherchiert">0</span>
                <span class="stat-label">Recherchiert</span>
            </div>
            <div class="stat-item clickable" onclick="filterByStatus('anschreiben_erstellt')">
                <span class="stat-value" id="statAnschreiben">0</span>
                <span class="stat-label">Anschreiben</span>
            </div>
        </div>

        <!-- Bulk Actions Toolbar -->
        <div class="bulk-actions" id="bulkActions" style="display: none;">
            <div class="bulk-actions-info">
                <input type="checkbox" id="selectAllLeads" class="bulk-checkbox" onclick="toggleSelectAll()">
                <span id="selectedCount">0</span> ausgew√§hlt
            </div>
            <div class="bulk-actions-buttons">
                <button class="btn btn-danger btn-small" onclick="deleteSelectedLeads()">
                    <span>üóëÔ∏è</span> Ausgew√§hlte l√∂schen
                </button>
                <button class="btn btn-outline btn-small" onclick="clearSelection()">
                    Auswahl aufheben
                </button>
            </div>
        </div>

        <!-- Lead List -->
        <div class="lead-list" id="leadList">
            <div class="loading">Leads werden geladen...</div>
        </div>
    </div>

    <!-- Modal for Cover Letter -->
    <div id="letterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Anschreiben bearbeiten</h2>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Ihr Name</label>
                    <input type="text" id="absenderName" class="form-input" placeholder="Max Mustermann">
                </div>
                <div class="form-group">
                    <label>Ihre Firma</label>
                    <input type="text" id="absenderFirma" class="form-input" placeholder="Ihre Firma GmbH">
                </div>
                <div class="form-group">
                    <label>Anschreiben</label>
                    <textarea id="letterText" class="form-textarea" rows="12"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">Abbrechen</button>
                <button class="btn btn-secondary" onclick="copyLetter()">
                    <span>üìã</span> Kopieren
                </button>
                <button class="btn btn-primary" onclick="saveLetter()">
                    <span>üíæ</span> Speichern
                </button>
            </div>
        </div>
    </div>

    <!-- Modal for StepStone Import -->
    <div id="importModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><span>üì•</span> StepStone Import</h2>
                <button class="modal-close" onclick="closeImportModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Search Form -->
                <div class="import-search-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Suchbegriffe (Keywords)</label>
                            <input type="text" id="searchKeywords" class="form-input"
                                   placeholder="KI, AI, GenAI, Copilot..." value="KI AI GenAI Copilot">
                        </div>
                        <div class="form-group">
                            <label>Job-Titel Filter</label>
                            <input type="text" id="searchJobTitle" class="form-input"
                                   placeholder="z.B. Engineer, Manager...">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Stadt / Region</label>
                            <input type="text" id="searchLocation" class="form-input"
                                   placeholder="z.B. Berlin, M√ºnchen, Hamburg...">
                        </div>
                        <div class="form-group">
                            <label>Umkreis (km)</label>
                            <select id="searchRadius" class="filter-select">
                                <option value="10">10 km</option>
                                <option value="20">20 km</option>
                                <option value="30" selected>30 km</option>
                                <option value="50">50 km</option>
                                <option value="100">100 km</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ver√∂ffentlicht nach</label>
                            <select id="searchDateFilter" class="filter-select">
                                <option value="">Beliebig</option>
                                <option value="1">Letzte 24 Stunden</option>
                                <option value="3">Letzte 3 Tage</option>
                                <option value="7" selected>Letzte 7 Tage</option>
                                <option value="14">Letzte 14 Tage</option>
                                <option value="30">Letzte 30 Tage</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Max. Ergebnisse</label>
                            <select id="searchMaxResults" class="filter-select">
                                <option value="5">5 Ergebnisse</option>
                                <option value="10" selected>10 Ergebnisse</option>
                                <option value="20">20 Ergebnisse</option>
                                <option value="50">50 Ergebnisse</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button id="searchStepStone" class="btn btn-primary btn-large">
                            <span>üîç</span> Jetzt Suchen
                        </button>
                    </div>
                </div>

                <!-- Search Results -->
                <div id="searchResults" class="search-results" style="display: none;">
                    <div class="results-header">
                        <h3 id="resultsCount">0 Ergebnisse gefunden</h3>
                        <div class="results-actions">
                            <button id="selectAllResults" class="btn btn-outline btn-small">
                                Alle ausw√§hlen
                            </button>
                            <button id="deselectAllResults" class="btn btn-outline btn-small">
                                Alle abw√§hlen
                            </button>
                        </div>
                    </div>
                    <div id="resultsList" class="results-list">
                        <!-- Results will be rendered here -->
                    </div>
                </div>

                <!-- Loading State -->
                <div id="searchLoading" class="search-loading" style="display: none;">
                    <div class="loading">StepStone wird durchsucht...</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeImportModal()">Abbrechen</button>
                <button id="importSelected" class="btn btn-success" disabled>
                    <span>üì•</span> <span id="importCount">0</span> ausgew√§hlte importieren
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast" class="toast"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>
